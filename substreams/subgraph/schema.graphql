type TokenHolder @entity {
    id: Bytes!
    mint: Bytes!
    user: Bytes! @unique
    balance: BigInt!
    token_accounts: [TokenAccount!]! @derivedFrom(field: "owner")
}

type TokenAccount @entity {
    id: Bytes!
    pubkey: Bytes! @unique
    owner: TokenHolder!
    balance: BigInt!
    claims: [Claim!]! @derivedFrom(field: "token_account")
    cumulative_claims: BigInt!
    transfers: [BalanceUpdate!]! @derivedFrom(field: "token_account")
}

type Claim @entity(immutable: true) {
    id: Bytes!
    amount: BigInt!
    index: BigInt!
    ts: Timestamp!
    token_account: TokenAccount!
}

type BalanceUpdate @entity(immutable: true) {
    id: Bytes!
    amount: BigInt!
    ts: Timestamp!
    token_account: TokenAccount!
}

type IndexUpdates @entity {
    id: Bytes!
    updates: [IndexUpdate!]!
    last_index: BigInt!
    last_ts: BigInt!
}

type IndexUpdate @entity(immutable: true) {
    id: Bytes!
    index: BigInt!
    ts: Timestamp!
}

type Timestamp @entity(immutable: true) {
    id: Bytes!
    ts: BigInt!
    block: BigInt!
    signature: Bytes!
}